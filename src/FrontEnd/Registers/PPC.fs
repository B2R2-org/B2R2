(*
  B2R2 - the Next-Generation Reversing Platform

  Copyright (c) SoftSec Lab. @ KAIST, since 2016

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*)

namespace B2R2.FrontEnd.PPC

open B2R2

/// <namespacedoc>
///   <summary>
///   Contains types and functions for working with the PPC instructions.
///   </summary>
/// </namespacedoc>
/// <summary>
/// Represents registers for PPC.<para/>
/// </summary>
type Register =
  | R0 = 0x0
  | R1 = 0x1
  | R2 = 0x2
  | R3 = 0x3
  | R4 = 0x4
  | R5 = 0x5
  | R6 = 0x6
  | R7 = 0x7
  | R8 = 0x8
  | R9 = 0x9
  | R10 = 0xA
  | R11 = 0xB
  | R12 = 0xC
  | R13 = 0xD
  | R14 = 0xE
  | R15 = 0xF
  | R16 = 0x10
  | R17 = 0x11
  | R18 = 0x12
  | R19 = 0x13
  | R20 = 0x14
  | R21 = 0x15
  | R22 = 0x16
  | R23 = 0x17
  | R24 = 0x18
  | R25 = 0x19
  | R26 = 0x1A
  | R27 = 0x1B
  | R28 = 0x1C
  | R29 = 0x1D
  | R30 = 0x1E
  | R31 = 0x1F
  | F0 = 0x20
  | F1 = 0x21
  | F2 = 0x22
  | F3 = 0x23
  | F4 = 0x24
  | F5 = 0x25
  | F6 = 0x26
  | F7 = 0x27
  | F8 = 0x28
  | F9 = 0x29
  | F10 = 0x2A
  | F11 = 0x2B
  | F12 = 0x2C
  | F13 = 0x2D
  | F14 = 0x2E
  | F15 = 0x2F
  | F16 = 0x30
  | F17 = 0x31
  | F18 = 0x32
  | F19 = 0x33
  | F20 = 0x34
  | F21 = 0x35
  | F22 = 0x36
  | F23 = 0x37
  | F24 = 0x38
  | F25 = 0x39
  | F26 = 0x3A
  | F27 = 0x3B
  | F28 = 0x3C
  | F29 = 0x3D
  | F30 = 0x3E
  | F31 = 0x3F
  | VS0 = 0x40
  | VS1 = 0x41
  | VS2 = 0x42
  | VS3 = 0x43
  | VS4 = 0x44
  | VS5 = 0x45
  | VS6 = 0x46
  | VS7 = 0x47
  | VS8 = 0x48
  | VS9 = 0x49
  | VS10 = 0x4A
  | VS11 = 0x4B
  | VS12 = 0x4C
  | VS13 = 0x4D
  | VS14 = 0x4E
  | VS15 = 0x4F
  | VS16 = 0x50
  | VS17 = 0x51
  | VS18 = 0x52
  | VS19 = 0x53
  | VS20 = 0x54
  | VS21 = 0x55
  | VS22 = 0x56
  | VS23 = 0x57
  | VS24 = 0x58
  | VS25 = 0x59
  | VS26 = 0x5A
  | VS27 = 0x5B
  | VS28 = 0x5C
  | VS29 = 0x5D
  | VS30 = 0x5E
  | VS31 = 0x5F
  | VS32 = 0x60
  | VS33 = 0x61
  | VS34 = 0x62
  | VS35 = 0x63
  | VS36 = 0x64
  | VS37 = 0x65
  | VS38 = 0x66
  | VS39 = 0x67
  | VS40 = 0x68
  | VS41 = 0x69
  | VS42 = 0x6A
  | VS43 = 0x6B
  | VS44 = 0x6C
  | VS45 = 0x6D
  | VS46 = 0x6E
  | VS47 = 0x6F
  | VS48 = 0x70
  | VS49 = 0x71
  | VS50 = 0x72
  | VS51 = 0x73
  | VS52 = 0x74
  | VS53 = 0x75
  | VS54 = 0x76
  | VS55 = 0x77
  | VS56 = 0x78
  | VS57 = 0x79
  | VS58 = 0x7A
  | VS59 = 0x7B
  | VS60 = 0x7C
  | VS61 = 0x7D
  | VS62 = 0x7E
  | VS63 = 0x7F
  | CR0 = 0x80
  | CR1 = 0x81
  | CR2 = 0x82
  | CR3 = 0x83
  | CR4 = 0x84
  | CR5 = 0x85
  | CR6 = 0x86
  | CR7 = 0x87
  | CR0_0 = 0x88
  | CR0_1 = 0x89
  | CR0_2 = 0x8A
  | CR0_3 = 0x8B
  | CR1_0 = 0x8C
  | CR1_1 = 0x8D
  | CR1_2 = 0x8E
  | CR1_3 = 0x8F
  | CR2_0 = 0x90
  | CR2_1 = 0x91
  | CR2_2 = 0x92
  | CR2_3 = 0x93
  | CR3_0 = 0x94
  | CR3_1 = 0x95
  | CR3_2 = 0x96
  | CR3_3 = 0x97
  | CR4_0 = 0x98
  | CR4_1 = 0x99
  | CR4_2 = 0x9A
  | CR4_3 = 0x9B
  | CR5_0 = 0x9C
  | CR5_1 = 0x9D
  | CR5_2 = 0x9E
  | CR5_3 = 0x9F
  | CR6_0 = 0xA0
  | CR6_1 = 0xA1
  | CR6_2 = 0xA2
  | CR6_3 = 0xA3
  | CR7_0 = 0xA4
  | CR7_1 = 0xA5
  | CR7_2 = 0xA6
  | CR7_3 = 0xA7
  | XER = 0xA8
  | DSCR = 0xA9
  | LR = 0xAA
  | CTR = 0xAB
  | AMR = 0xAC
  | TFHAR = 0xAD
  | TFIAR = 0xAE
  | TEXASR = 0xAF
  | TEXASRU = 0xB0
  | VRSAVE = 0xB1
  | MMCR2 = 0xB2
  | MMCRA = 0xB3
  | PMC1 = 0xB4
  | PMC2 = 0xB5
  | PMC3 = 0xB6
  | PMC4 = 0xB7
  | PMC5 = 0xB8
  | PMC6 = 0xB9
  | MMCR0 = 0xBA
  | BESCRS = 0xBB
  | BESCRSU = 0xBC
  | BESCRR = 0xBD
  | BESCRRU = 0xBE
  | EBBHR = 0xBF
  | EBBRR = 0xC0
  | BESCR = 0xC1
  | ReservedSPR = 0xC2
  | TAR = 0xC3
  | PPR = 0xC4
  | PPR32 = 0xC5

/// Provides functions to handle PPC registers.
module Register =
  /// Returns the PPC register from a register ID.
  [<CompiledName "OfRegID">]
  let inline ofRegID (rid: RegisterID): Register =
    int rid |> LanguagePrimitives.EnumOfValue

  /// Returns the PPC register from a string representation.
  [<CompiledName "OfString">]
  let ofString (str: string) =
    match str.ToLowerInvariant() with
    | "r0" -> Register.R0
    | "r1" -> Register.R1
    | "r2" -> Register.R2
    | "r3" -> Register.R3
    | "r4" -> Register.R4
    | "r5" -> Register.R5
    | "r6" -> Register.R6
    | "r7" -> Register.R7
    | "r8" -> Register.R8
    | "r9" -> Register.R9
    | "r10" -> Register.R10
    | "r11" -> Register.R11
    | "r12" -> Register.R12
    | "r13" -> Register.R13
    | "r14" -> Register.R14
    | "r15" -> Register.R15
    | "r16" -> Register.R16
    | "r17" -> Register.R17
    | "r18" -> Register.R18
    | "r19" -> Register.R19
    | "r20" -> Register.R20
    | "r21" -> Register.R21
    | "r22" -> Register.R22
    | "r23" -> Register.R23
    | "r24" -> Register.R24
    | "r25" -> Register.R25
    | "r26" -> Register.R26
    | "r27" -> Register.R27
    | "r28" -> Register.R28
    | "r29" -> Register.R29
    | "r30" -> Register.R30
    | "r31" -> Register.R31
    | "f0" -> Register.F0
    | "f1" -> Register.F1
    | "f2" -> Register.F2
    | "f3" -> Register.F3
    | "f4" -> Register.F4
    | "f5" -> Register.F5
    | "f6" -> Register.F6
    | "f7" -> Register.F7
    | "f8" -> Register.F8
    | "f9" -> Register.F9
    | "f10" -> Register.F10
    | "f11" -> Register.F11
    | "f12" -> Register.F12
    | "f13" -> Register.F13
    | "f14" -> Register.F14
    | "f15" -> Register.F15
    | "f16" -> Register.F16
    | "f17" -> Register.F17
    | "f18" -> Register.F18
    | "f19" -> Register.F19
    | "f20" -> Register.F20
    | "f21" -> Register.F21
    | "f22" -> Register.F22
    | "f23" -> Register.F23
    | "f24" -> Register.F24
    | "f25" -> Register.F25
    | "f26" -> Register.F26
    | "f27" -> Register.F27
    | "f28" -> Register.F28
    | "f29" -> Register.F29
    | "f30" -> Register.F30
    | "f31" -> Register.F31
    | "vs0" -> Register.VS0
    | "vs1" -> Register.VS1
    | "vs2" -> Register.VS2
    | "vs3" -> Register.VS3
    | "vs4" -> Register.VS4
    | "vs5" -> Register.VS5
    | "vs6" -> Register.VS6
    | "vs7" -> Register.VS7
    | "vs8" -> Register.VS8
    | "vs9" -> Register.VS9
    | "vs10" -> Register.VS10
    | "vs11" -> Register.VS11
    | "vs12" -> Register.VS12
    | "vs13" -> Register.VS13
    | "vs14" -> Register.VS14
    | "vs15" -> Register.VS15
    | "vs16" -> Register.VS16
    | "vs17" -> Register.VS17
    | "vs18" -> Register.VS18
    | "vs19" -> Register.VS19
    | "vs20" -> Register.VS20
    | "vs21" -> Register.VS21
    | "vs22" -> Register.VS22
    | "vs23" -> Register.VS23
    | "vs24" -> Register.VS24
    | "vs25" -> Register.VS25
    | "vs26" -> Register.VS26
    | "vs27" -> Register.VS27
    | "vs28" -> Register.VS28
    | "vs29" -> Register.VS29
    | "vs30" -> Register.VS30
    | "vs31" -> Register.VS31
    | "vs32" -> Register.VS32
    | "vs33" -> Register.VS33
    | "vs34" -> Register.VS34
    | "vs35" -> Register.VS35
    | "vs36" -> Register.VS36
    | "vs37" -> Register.VS37
    | "vs38" -> Register.VS38
    | "vs39" -> Register.VS39
    | "vs40" -> Register.VS40
    | "vs41" -> Register.VS41
    | "vs42" -> Register.VS42
    | "vs43" -> Register.VS43
    | "vs44" -> Register.VS44
    | "vs45" -> Register.VS45
    | "vs46" -> Register.VS46
    | "vs47" -> Register.VS47
    | "vs48" -> Register.VS48
    | "vs49" -> Register.VS49
    | "vs50" -> Register.VS50
    | "vs51" -> Register.VS51
    | "vs52" -> Register.VS52
    | "vs53" -> Register.VS53
    | "vs54" -> Register.VS54
    | "vs55" -> Register.VS55
    | "vs56" -> Register.VS56
    | "vs57" -> Register.VS57
    | "vs58" -> Register.VS58
    | "vs59" -> Register.VS59
    | "vs60" -> Register.VS60
    | "vs61" -> Register.VS61
    | "vs62" -> Register.VS62
    | "vs63" -> Register.VS63
    | "cr0" -> Register.CR0
    | "cr1" -> Register.CR1
    | "cr2" -> Register.CR2
    | "cr3" -> Register.CR3
    | "cr4" -> Register.CR4
    | "cr5" -> Register.CR5
    | "cr6" -> Register.CR6
    | "cr7" -> Register.CR7
    | "cr0_0" -> Register.CR0_0
    | "cr0_1" -> Register.CR0_1
    | "cr0_2" -> Register.CR0_2
    | "cr0_3" -> Register.CR0_3
    | "cr1_0" -> Register.CR1_0
    | "cr1_1" -> Register.CR1_1
    | "cr1_2" -> Register.CR1_2
    | "cr1_3" -> Register.CR1_3
    | "cr2_0" -> Register.CR2_0
    | "cr2_1" -> Register.CR2_1
    | "cr2_2" -> Register.CR2_2
    | "cr2_3" -> Register.CR2_3
    | "cr3_0" -> Register.CR3_0
    | "cr3_1" -> Register.CR3_1
    | "cr3_2" -> Register.CR3_2
    | "cr3_3" -> Register.CR3_3
    | "cr4_0" -> Register.CR4_0
    | "cr4_1" -> Register.CR4_1
    | "cr4_2" -> Register.CR4_2
    | "cr4_3" -> Register.CR4_3
    | "cr5_0" -> Register.CR5_0
    | "cr5_1" -> Register.CR5_1
    | "cr5_2" -> Register.CR5_2
    | "cr5_3" -> Register.CR5_3
    | "cr6_0" -> Register.CR6_0
    | "cr6_1" -> Register.CR6_1
    | "cr6_2" -> Register.CR6_2
    | "cr6_3" -> Register.CR6_3
    | "cr7_0" -> Register.CR7_0
    | "cr7_1" -> Register.CR7_1
    | "cr7_2" -> Register.CR7_2
    | "cr7_3" -> Register.CR7_3
    | "xer" -> Register.XER
    | "dscr" -> Register.DSCR
    | "lr" -> Register.LR
    | "ctr" -> Register.CTR
    | "amr" -> Register.AMR
    | "tfhar" -> Register.TFHAR
    | "tfiar" -> Register.TFIAR
    | "texasr" -> Register.TEXASR
    | "texasru" -> Register.TEXASRU
    | "vrsave" -> Register.VRSAVE
    | "mmcr2" -> Register.MMCR2
    | "mmcra" -> Register.MMCRA
    | "pmc1" -> Register.PMC1
    | "pmc2" -> Register.PMC2
    | "pmc3" -> Register.PMC3
    | "pmc4" -> Register.PMC4
    | "pmc5" -> Register.PMC5
    | "pmc6" -> Register.PMC6
    | "mmcr0" -> Register.MMCR0
    | "bescrs" -> Register.BESCRS
    | "bescrsu" -> Register.BESCRSU
    | "bescrr" -> Register.BESCRR
    | "bescrru" -> Register.BESCRRU
    | "ebbhr" -> Register.EBBHR
    | "ebbrr" -> Register.EBBRR
    | "bescr" -> Register.BESCR
    | "reservedspr" -> Register.ReservedSPR
    | "tar" -> Register.TAR
    | "ppr" -> Register.PPR
    | "ppr32" -> Register.PPR32
    | _ -> Terminator.futureFeature ()

  /// Returns the register ID of a PPC register.
  [<CompiledName "ToRegID">]
  let inline toRegID (reg: Register) =
    LanguagePrimitives.EnumToValue(reg) |> RegisterID.create

  /// Returns the string representation of a PPC register.
  [<CompiledName "ToString">]
  let toString reg =
    match reg with
    | Register.R0 -> "r0"
    | Register.R1 -> "r1"
    | Register.R2 -> "r2"
    | Register.R3 -> "r3"
    | Register.R4 -> "r4"
    | Register.R5 -> "r5"
    | Register.R6 -> "r6"
    | Register.R7 -> "r7"
    | Register.R8 -> "r8"
    | Register.R9 -> "r9"
    | Register.R10 -> "r10"
    | Register.R11 -> "r11"
    | Register.R12 -> "r12"
    | Register.R13 -> "r13"
    | Register.R14 -> "r14"
    | Register.R15 -> "r15"
    | Register.R16 -> "r16"
    | Register.R17 -> "r17"
    | Register.R18 -> "r18"
    | Register.R19 -> "r19"
    | Register.R20 -> "r20"
    | Register.R21 -> "r21"
    | Register.R22 -> "r22"
    | Register.R23 -> "r23"
    | Register.R24 -> "r24"
    | Register.R25 -> "r25"
    | Register.R26 -> "r26"
    | Register.R27 -> "r27"
    | Register.R28 -> "r28"
    | Register.R29 -> "r29"
    | Register.R30 -> "r30"
    | Register.R31 -> "r31"
    | Register.F0 -> "f0"
    | Register.F1 -> "f1"
    | Register.F2 -> "f2"
    | Register.F3 -> "f3"
    | Register.F4 -> "f4"
    | Register.F5 -> "f5"
    | Register.F6 -> "f6"
    | Register.F7 -> "f7"
    | Register.F8 -> "f8"
    | Register.F9 -> "f9"
    | Register.F10 -> "f10"
    | Register.F11 -> "f11"
    | Register.F12 -> "f12"
    | Register.F13 -> "f13"
    | Register.F14 -> "f14"
    | Register.F15 -> "f15"
    | Register.F16 -> "f16"
    | Register.F17 -> "f17"
    | Register.F18 -> "f18"
    | Register.F19 -> "f19"
    | Register.F20 -> "f20"
    | Register.F21 -> "f21"
    | Register.F22 -> "f22"
    | Register.F23 -> "f23"
    | Register.F24 -> "f24"
    | Register.F25 -> "f25"
    | Register.F26 -> "f26"
    | Register.F27 -> "f27"
    | Register.F28 -> "f28"
    | Register.F29 -> "f29"
    | Register.F30 -> "f30"
    | Register.F31 -> "f31"
    | Register.VS0 -> "vs0"
    | Register.VS1 -> "vs1"
    | Register.VS2 -> "vs2"
    | Register.VS3 -> "vs3"
    | Register.VS4 -> "vs4"
    | Register.VS5 -> "vs5"
    | Register.VS6 -> "vs6"
    | Register.VS7 -> "vs7"
    | Register.VS8 -> "vs8"
    | Register.VS9 -> "vs9"
    | Register.VS10 -> "vs10"
    | Register.VS11 -> "vs11"
    | Register.VS12 -> "vs12"
    | Register.VS13 -> "vs13"
    | Register.VS14 -> "vs14"
    | Register.VS15 -> "vs15"
    | Register.VS16 -> "vs16"
    | Register.VS17 -> "vs17"
    | Register.VS18 -> "vs18"
    | Register.VS19 -> "vs19"
    | Register.VS20 -> "vs20"
    | Register.VS21 -> "vs21"
    | Register.VS22 -> "vs22"
    | Register.VS23 -> "vs23"
    | Register.VS24 -> "vs24"
    | Register.VS25 -> "vs25"
    | Register.VS26 -> "vs26"
    | Register.VS27 -> "vs27"
    | Register.VS28 -> "vs28"
    | Register.VS29 -> "vs29"
    | Register.VS30 -> "vs30"
    | Register.VS31 -> "vs31"
    | Register.VS32 -> "vs32"
    | Register.VS33 -> "vs33"
    | Register.VS34 -> "vs34"
    | Register.VS35 -> "vs35"
    | Register.VS36 -> "vs36"
    | Register.VS37 -> "vs37"
    | Register.VS38 -> "vs38"
    | Register.VS39 -> "vs39"
    | Register.VS40 -> "vs40"
    | Register.VS41 -> "vs41"
    | Register.VS42 -> "vs42"
    | Register.VS43 -> "vs43"
    | Register.VS44 -> "vs44"
    | Register.VS45 -> "vs45"
    | Register.VS46 -> "vs46"
    | Register.VS47 -> "vs47"
    | Register.VS48 -> "vs48"
    | Register.VS49 -> "vs49"
    | Register.VS50 -> "vs50"
    | Register.VS51 -> "vs51"
    | Register.VS52 -> "vs52"
    | Register.VS53 -> "vs53"
    | Register.VS54 -> "vs54"
    | Register.VS55 -> "vs55"
    | Register.VS56 -> "vs56"
    | Register.VS57 -> "vs57"
    | Register.VS58 -> "vs58"
    | Register.VS59 -> "vs59"
    | Register.VS60 -> "vs60"
    | Register.VS61 -> "vs61"
    | Register.VS62 -> "vs62"
    | Register.VS63 -> "vs63"
    | Register.CR0 -> "cr0"
    | Register.CR1 -> "cr1"
    | Register.CR2 -> "cr2"
    | Register.CR3 -> "cr3"
    | Register.CR4 -> "cr4"
    | Register.CR5 -> "cr5"
    | Register.CR6 -> "cr6"
    | Register.CR7 -> "cr7"
    | Register.CR0_0 -> "cr0_0"
    | Register.CR0_1 -> "cr0_1"
    | Register.CR0_2 -> "cr0_2"
    | Register.CR0_3 -> "cr0_3"
    | Register.CR1_0 -> "cr1_0"
    | Register.CR1_1 -> "cr1_1"
    | Register.CR1_2 -> "cr1_2"
    | Register.CR1_3 -> "cr1_3"
    | Register.CR2_0 -> "cr2_0"
    | Register.CR2_1 -> "cr2_1"
    | Register.CR2_2 -> "cr2_2"
    | Register.CR2_3 -> "cr2_3"
    | Register.CR3_0 -> "cr3_0"
    | Register.CR3_1 -> "cr3_1"
    | Register.CR3_2 -> "cr3_2"
    | Register.CR3_3 -> "cr3_3"
    | Register.CR4_0 -> "cr4_0"
    | Register.CR4_1 -> "cr4_1"
    | Register.CR4_2 -> "cr4_2"
    | Register.CR4_3 -> "cr4_3"
    | Register.CR5_0 -> "cr5_0"
    | Register.CR5_1 -> "cr5_1"
    | Register.CR5_2 -> "cr5_2"
    | Register.CR5_3 -> "cr5_3"
    | Register.CR6_0 -> "cr6_0"
    | Register.CR6_1 -> "cr6_1"
    | Register.CR6_2 -> "cr6_2"
    | Register.CR6_3 -> "cr6_3"
    | Register.CR7_0 -> "cr7_0"
    | Register.CR7_1 -> "cr7_1"
    | Register.CR7_2 -> "cr7_2"
    | Register.CR7_3 -> "cr7_3"
    | Register.XER -> "xer"
    | Register.DSCR -> "dscr"
    | Register.LR -> "lr"
    | Register.CTR -> "ctr"
    | Register.AMR -> "amr"
    | Register.TFHAR -> "tfhar"
    | Register.TFIAR -> "tfiar"
    | Register.TEXASR -> "texasr"
    | Register.TEXASRU -> "texasru"
    | Register.VRSAVE -> "vrsave"
    | Register.MMCR2 -> "mmcr2"
    | Register.MMCRA -> "mmcra"
    | Register.PMC1 -> "pmc1"
    | Register.PMC2 -> "pmc2"
    | Register.PMC3 -> "pmc3"
    | Register.PMC4 -> "pmc4"
    | Register.PMC5 -> "pmc5"
    | Register.PMC6 -> "pmc6"
    | Register.MMCR0 -> "mmcr0"
    | Register.BESCRS -> "bescrs"
    | Register.BESCRSU -> "bescrsu"
    | Register.BESCRR -> "bescrr"
    | Register.BESCRRU -> "bescrru"
    | Register.EBBHR -> "ebbhr"
    | Register.EBBRR -> "ebbrr"
    | Register.BESCR -> "bescr"
    | Register.ReservedSPR -> "reservedspr"
    | Register.TAR -> "tar"
    | Register.PPR -> "ppr"
    | Register.PPR32 -> "ppr32"
    | _ -> Terminator.futureFeature ()
